<div id='ticket'>
  <h2><%= @ticket.title %></h2>  
  <span id="author">Created by <%= @ticket.user.name %></span>

  <%= simple_format(@ticket.description) %>

  <%= render @ticket.state if @ticket.state %>

  <% if @ticket.assets.present? %>
  <h3>Attached Files</h3>
  <div class="assets">
    <% @ticket.assets.each do |asset| %>
      <p>
        <%= link_to File.basename(asset.asset.path), file_path(asset) %>
      </p>
      <p>
        <small><%= number_to_human_size(asset.asset.size) %></small>
      </p>
    <% end %>
  </div>
  <% end %>

  <div id='comments'>
    <h3>Comments</h3>
    <% @ticket.comments.select(&:persisted?).each do |comment| %>
      <%= div_for(comment) do %>
        <h4>Added by <%= comment.user.name %> on <%= comment.created_at %>:</h4>
        <p><%= simple_format(comment.content) %></p>
      <% end %>
    <% end %>

    <%= render "comments/form" %>
  </div>

  <p>
  <% authorized?(:edit_tickets, @project) do %>
    <%= link_to "Edit Ticket", [:edit, @project, @ticket] %>
  <% end %>

  <% authorized?(:delete_tickets, @project) do %>
    <%= link_to "Delete Ticket", [@project, @ticket],
                method: :delete,
                data: { confirm: "Are you sure you want to delete this ticket?" }
     %>
  <% end %>
  </p>
</div>